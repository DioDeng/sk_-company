(function(){"use strict";var e={8113:function(e,t,a){a.d(t,{Qb:function(){return v},kn:function(){return h},ak:function(){return u},mV:function(){return k},Pf:function(){return L},TD:function(){return M},Ac:function(){return m},o:function(){return i},FF:function(){return C},q7:function(){return $},UP:function(){return f},mf:function(){return y},Lk:function(){return d},Lb:function(){return g},tU:function(){return c},BM:function(){return r},Us:function(){return F},Z3:function(){return b},UB:function(){return p},Xr:function(){return w}});var s=a(4373),o=a(7543);const n=s.A.create({baseURL:"https://skcomponany.zeabur.app"});n.interceptors.request.use((e=>{const t=(0,o.gf)();return t&&(e.headers.Authorization=`Bearer ${t}`),e}));var l=n;const i=()=>l.get("/employees"),r=e=>l.post("/employees",e),d=(e,t)=>l.put(`/employees/${e}`,t),u=e=>l.delete(`/employees/${e}`),m=()=>l.get("/cases?active=true"),c=e=>l.post("/cases",e),p=(e,t)=>l.put(`/cases/${e}`,t),h=(e,t)=>l.delete(`/cases/${e}`,t),f=()=>l.get("/vendors?active=true"),b=e=>l.post("/vendors",e),g=(e,t)=>l.put(`/vendors/${t}`,e),k=e=>l.delete(`/vendors/${e}`),v=e=>l.post("/worklogs",e),y=e=>l.get("/worklogs",{params:e}),L=e=>l.delete(`/worklogs/${e}`),C=e=>l.get(`/api/WorkOrders/${e}`),M=e=>l.get("/payroll/all",{params:e}),$=(e,t)=>l.get(`/payroll/${e}`,{params:t}),F=e=>l.post("/payroll/generate",null,{params:e}),w=e=>l.post("/auth/login",e)},7543:function(e,t,a){function s(e){localStorage.setItem("token",e)}function o(){return localStorage.getItem("token")}function n(){localStorage.removeItem("token")}a.d(t,{WG:function(){return s},eF:function(){return n},gf:function(){return o}})},3479:function(e,t,a){var s=a(5130),o=a(482),n=a(3224),l=a(4164),i=a(1066),r=a(3699),d=a.n(r),u=a(595),m=a(8077),c=a(6768),p=a(4232);const h={style:{"background-color":"#dee0d8"}},f={class:"container py-4"},b={class:"row text-center"},g={class:"col-2"},k={class:"card border-2 border-dark rounded-4 h-100"},v={class:"col-10"};function y(e,t,a,s,o,n){const l=(0,c.g2)("Navbar"),i=(0,c.g2)("router-view"),r=(0,c.g2)("Message"),d=(0,c.g2)("Loading"),u=(0,c.g2)("EmployeesModal"),m=(0,c.g2)("VendorModal"),y=(0,c.g2)("InforModal"),L=(0,c.g2)("CaseModal"),C=(0,c.g2)("Demooffcans");return(0,c.uX)(),(0,c.CE)(c.FK,null,[(0,c.Lk)("section",h,[(0,c.Lk)("section",f,[(0,c.Lk)("div",b,[(0,c.Lk)("div",g,[(0,c.Lk)("div",k,[(0,c.bF)(l)])]),(0,c.Lk)("div",v,[(0,c.Lk)("div",{class:"card rounded-4 p-4 bg-body border border-2 border-dark",style:(0,p.Tr)({height:o.height+"px"})},[(0,c.bF)(i)],4)])])]),(0,c.bF)(r),(0,c.bF)(d)]),(0,c.bF)(u),(0,c.bF)(m),(0,c.bF)(y),(0,c.bF)(L),(0,c.bF)(C)],64)}const L={class:"py-4 px-3 d-flex align-items-center flex-column h-100"},C={class:"list-unstyled py-3 w-100"};function M(e,t,a,s,o,n){const l=(0,c.g2)("router-link");return(0,c.uX)(),(0,c.CE)("section",L,[t[1]||(t[1]=(0,c.Lk)("h5",{class:"border-bottom w-100 pb-3"},"工單系統",-1)),(0,c.Lk)("ul",C,[((0,c.uX)(!0),(0,c.CE)(c.FK,null,(0,c.pI)(o.menuList,((e,t)=>((0,c.uX)(),(0,c.CE)("li",{key:t,class:(0,p.C4)(["p-3 rounded w-100",{checked:this.$route.path.split("/")[1]===e.path.split("/")[1]}])},[(0,c.bF)(l,{to:e.path,class:"text-decoration-none h5"},{default:(0,c.k6)((()=>[(0,c.Lk)("i",{class:(0,p.C4)(["bi me-2",e.icon])},null,2),(0,c.eW)((0,p.v_)(e.title),1)])),_:2},1032,["to"])],2)))),128))]),(0,c.Lk)("button",{class:"btn btn-outline-danger mt-auto",onClick:t[0]||(t[0]=(...e)=>n.logout&&n.logout(...e))}," 登出 ")])}a(4114);var $=a(7543),F={data(){return{menuList:[{title:"工單",icon:"bi-list-task text-warning",color:"warning",path:"/order"},{title:"案子",icon:"bi-list-task text-dark",color:"dark",path:"/case"},{title:"員工",icon:"bi-people text-success",color:"success",path:"/employees"},{title:"廠商",icon:"bi-building text-info",color:"info",path:"/company"},{title:"薪資",icon:"bi-building text-info",color:"primary",path:"/payroll"}]}},computed:{isLogin(){return!!localStorage.getItem("token")}},methods:{logout(){this.$emitter.emit("loadingStatus",!0),(0,$.eF)(),this.$emitter.emit("loadingStatus",!1),this.$emitter.emit("messageModal",{status:!0,message:"已登出"}),this.$router.push("/login")}}},w=a(1241);const E=(0,w.A)(F,[["render",M],["__scopeId","data-v-179b5e8e"]]);var x=E;const D={class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"addEditWorker"},V={class:"modal-dialog"},_={class:"modal-content"},S={class:"modal-header"},X={class:"modal-title fs-5",id:"exampleModalLabel"},I={key:0},N={key:1},O={class:"modal-body"},U={class:"form-floating mb-3"},A={for:"floatingInput"},W={class:"form-floating mb-3"},q={for:"phone"},P={class:"form-floating mb-3"},j={for:"floatingInput"},R={class:"modal-footer justify-content-between"},K=["disabled"];function T(e,t,a,s,o,n){const l=(0,c.g2)("VField"),i=(0,c.g2)("ErrorMessage"),r=(0,c.g2)("error-message"),d=(0,c.g2)("VForm");return(0,c.uX)(),(0,c.CE)("div",D,[(0,c.Lk)("div",V,[(0,c.Lk)("div",_,[(0,c.Lk)("div",S,[(0,c.Lk)("h1",X,[o.status?((0,c.uX)(),(0,c.CE)("span",I,"新增員工")):((0,c.uX)(),(0,c.CE)("span",N,"修改員工"))]),(0,c.Lk)("button",{type:"button",class:"btn-close",onClick:t[0]||(t[0]=(...e)=>n.hideModal&&n.hideModal(...e)),"aria-label":"Close"})]),(0,c.bF)(d,{ref:"formRefSignin",id:"profileForm",onSubmit:n.addEditWorker},{default:(0,c.k6)((({errors:e,meta:a})=>[(0,c.Lk)("div",O,[(0,c.Lk)("div",U,[(0,c.bF)(l,{name:"姓名",type:"text",rules:"required",class:"form-control",modelValue:o.tempData.name,"onUpdate:modelValue":t[1]||(t[1]=e=>o.tempData.name=e)},null,8,["modelValue"]),(0,c.Lk)("label",A,[t[5]||(t[5]=(0,c.eW)("員工姓名 ")),(0,c.bF)(i,{name:"姓名",class:"text-danger ms-3"})])]),(0,c.Lk)("div",W,[(0,c.bF)(l,{id:"phone",name:"phone",type:"text",class:(0,p.C4)(["form-control",{"is-invalid":e["phone"]}]),rules:n.isPhone,modelValue:o.tempData.phone,"onUpdate:modelValue":t[2]||(t[2]=e=>o.tempData.phone=e)},null,8,["class","rules","modelValue"]),(0,c.Lk)("label",q,[t[6]||(t[6]=(0,c.eW)("phone")),(0,c.bF)(r,{name:"phone",class:"text-danger ms-3"})])]),(0,c.Lk)("div",P,[(0,c.bF)(l,{name:"時薪",type:"text",modelValue:o.tempData.hourlyRate,"onUpdate:modelValue":t[3]||(t[3]=e=>o.tempData.hourlyRate=e),rules:n.validateHourlyRate,class:"form-control"},null,8,["modelValue","rules"]),(0,c.Lk)("label",j,[t[7]||(t[7]=(0,c.eW)("時薪 ")),(0,c.bF)(i,{name:"時薪",class:"text-danger ms-3"})])])]),(0,c.Lk)("div",R,[o.status?(0,c.Q3)("",!0):((0,c.uX)(),(0,c.CE)("button",{key:0,type:"button",class:"btn btn-outline-danger",onClick:t[4]||(t[4]=e=>n.deleteEmployees(o.tempData._id))}," 刪除員工資料 ")),t[8]||(t[8]=(0,c.Lk)("div",null,null,-1)),(0,c.Lk)("button",{type:"submit",class:"btn btn-primary",disabled:!a.valid}," 儲存 ",8,K)])])),_:1},8,["onSubmit"])])])],512)}var J=a(8113),B={data(){return{modal:"",status:!1,tempData:{name:"",phone:"",photoUrl:"",seniority:"",hourlyRate:0,entryDate:"",monthlySalary:10,role:"工人",identificationNumber:""}}},methods:{onHourlyRateInput(e){let{value:t}=e.target;t=t.replace(/[^\d.]/g,"");const a=t.split(".");a.length>2&&(t=`${a[0]}.${a[1]}`);const s=Number(t);!isNaN(s)&&s>2e3&&(t="2000"),this.tempData.hourlyRate=t},validateHourlyRate(e){if(!e)return"請輸入時薪";const t=Number(e);return isNaN(t)?"請輸入數字":t<100?"時薪不能低於 100":t>2e3?"時薪不能超過 2000":!!/^\d+(\.\d{1,2})?$/.test(e)||"最多只能到小數點後兩位"},isPhone(e){if(!e)return!0;const t=/^(09)[0-9]{8}$/;return!!t.test(e)||"需要正確的電話號碼"},addEditWorker(){if(void 0!==this.tempData.hourlyRate){const e=Number(this.tempData.hourlyRate);if(isNaN(e))return void this.$emitter.emit("messageModal",{status:!1,message:"時薪必須是數字"});this.tempData.hourlyRate=Math.round(100*e)/100}this.$emitter.emit("loadingStatus",!0),this.tempData._id?(0,J.Lk)(this.tempData._id,this.tempData).then((()=>{this.$emitter.emit("messageModal",{status:!0,message:"修改成功"}),this.$emitter.emit("getEmployeesLsit"),this.$emitter.emit("loadingStatus",!1),this.hideModal()})).catch((e=>{console.log(e),this.$emitter.emit("loadingStatus",!1)})):(0,J.BM)(this.tempData).then((()=>{this.$emitter.emit("messageModal",{status:!0,message:"新增成功"}),this.$emitter.emit("getEmployeesLsit"),this.hideModal()})).catch((e=>{this.$emitter.emit("messageModal",{status:!1,message:`新增失敗，原因：${JSON.stringify(e.response.data.errors)}`}),this.$emitter.emit("loadingStatus",!1)}))},deleteEmployees(e){(0,J.ak)(e).then((()=>{this.$emitter.emit("messageModal",{status:!0,message:"刪除成功"}),this.$emitter.emit("getEmployeesLsit"),this.hideModal()})).catch()},showModal(){this.modal.show()},hideModal(){this.tempData={name:"",phone:"",photoUrl:"",seniority:"",hourlyRate:"",entryDate:"",monthlySalary:"",role:"工人",identificationNumber:""},this.modal.hide()}},mounted(){this.modal=new m.aF(this.$refs.addEditWorker),this.$emitter.on("addEditWorker",(e=>{this.status=e.status,e.status||(this.tempData=JSON.parse(JSON.stringify(e.data))),this.showModal()}))}};const z=(0,w.A)(B,[["render",T]]);var H=z;const Q={class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"vendorModal"},Z={class:"modal-dialog"},G={class:"modal-content"},Y={class:"modal-header"},ee={class:"modal-title fs-5",id:"exampleModalLabel"},te={key:0},ae={key:1},se={class:"modal-body"},oe={class:"form-floating mb-3"},ne={for:"floatingInput"},le={class:"form-floating mb-3"},ie={for:"floatingInput"},re={class:"form-floating mb-3"},de={for:"phone"},ue={class:"form-floating mb-3"},me={for:"floatingInput"},ce={class:"form-floating mb-3"},pe={for:"floatingInput"},he={class:"modal-footer justify-content-between"},fe=["disabled"];function be(e,t,a,s,o,n){const l=(0,c.g2)("VField"),i=(0,c.g2)("ErrorMessage"),r=(0,c.g2)("error-message"),d=(0,c.g2)("VForm");return(0,c.uX)(),(0,c.CE)("div",Q,[(0,c.Lk)("div",Z,[(0,c.Lk)("div",G,[(0,c.Lk)("div",Y,[(0,c.Lk)("h1",ee,[o.status?((0,c.uX)(),(0,c.CE)("span",te,"新增廠商")):((0,c.uX)(),(0,c.CE)("span",ae,"修改廠商"))]),(0,c.Lk)("button",{type:"button",class:"btn-close",onClick:t[0]||(t[0]=(...e)=>n.hideModal&&n.hideModal(...e)),"aria-label":"Close"})]),(0,c.bF)(d,{ref:"formRefSignin",id:"profileForm",onSubmit:n.addEditWorker},{default:(0,c.k6)((({errors:e,meta:a})=>[(0,c.Lk)("div",se,[(0,c.Lk)("div",oe,[(0,c.bF)(l,{name:"姓名",type:"text",rules:"required",class:"form-control",modelValue:o.tempData.name,"onUpdate:modelValue":t[1]||(t[1]=e=>o.tempData.name=e)},null,8,["modelValue"]),(0,c.Lk)("label",ne,[t[7]||(t[7]=(0,c.eW)("廠商名稱 ")),(0,c.bF)(i,{name:"姓名",class:"text-danger ms-3"})])]),(0,c.Lk)("div",le,[(0,c.bF)(l,{name:"聯絡人",type:"text",rules:"required",class:"form-control",modelValue:o.tempData.contactPerson,"onUpdate:modelValue":t[2]||(t[2]=e=>o.tempData.contactPerson=e)},null,8,["modelValue"]),(0,c.Lk)("label",ie,[t[8]||(t[8]=(0,c.eW)("聯絡人名稱 ")),(0,c.bF)(i,{name:"聯絡人",class:"text-danger ms-3"})])]),(0,c.Lk)("div",re,[(0,c.bF)(l,{id:"phone",name:"phone",type:"text",class:(0,p.C4)(["form-control",{"is-invalid":e["phone"]}]),rules:n.isPhone,modelValue:o.tempData.phone,"onUpdate:modelValue":t[3]||(t[3]=e=>o.tempData.phone=e)},null,8,["class","rules","modelValue"]),(0,c.Lk)("label",de,[t[9]||(t[9]=(0,c.eW)("phone")),(0,c.bF)(r,{name:"phone",class:"text-danger ms-3"})])]),(0,c.Lk)("div",ue,[(0,c.bF)(l,{name:"地址",type:"text",class:"form-control",modelValue:o.tempData.address,"onUpdate:modelValue":t[4]||(t[4]=e=>o.tempData.address=e)},null,8,["modelValue"]),(0,c.Lk)("label",me,[t[10]||(t[10]=(0,c.eW)("廠商地址 ")),(0,c.bF)(i,{name:"地址",class:"text-danger ms-3"})])]),(0,c.Lk)("div",ce,[(0,c.bF)(l,{name:"統編",type:"text",modelValue:o.tempData.taxId,"onUpdate:modelValue":t[5]||(t[5]=e=>o.tempData.taxId=e),rules:{regex:/^[0-9]{8}$/},class:"form-control"},null,8,["modelValue"]),(0,c.Lk)("label",pe,[t[11]||(t[11]=(0,c.eW)("統編 ")),(0,c.bF)(i,{name:"統編",class:"text-danger ms-3"})])])]),(0,c.Lk)("div",he,[o.status?(0,c.Q3)("",!0):((0,c.uX)(),(0,c.CE)("button",{key:0,type:"button",class:"btn btn-outline-danger",onClick:t[6]||(t[6]=e=>n.deleteVendor(o.tempData._id))}," 刪除廠商資料 ")),t[12]||(t[12]=(0,c.Lk)("div",null,null,-1)),(0,c.Lk)("button",{type:"submit",class:"btn btn-primary",disabled:!a.valid}," 儲存 ",8,fe)])])),_:1},8,["onSubmit"])])])],512)}var ge={data(){return{modal:"",status:!1,tempData:{name:"",phone:"",contactPerson:"",taxId:"",address:""}}},methods:{isPhone(e){if(!e)return!0;const t=/^[0-9()+\-\s#extEXT]{6,20}$/;return!!t.test(e)||"電話格式不正確"},addEditWorker(){this.$emitter.emit("loadingStatus",!0),console.log(this.tempData),this.tempData._id?(0,J.Lb)(this.tempData,this.tempData._id).then((()=>{this.$emitter.emit("messageModal",{status:!0,message:"修改成功"}),this.$emitter.emit("getVendorLsit"),this.$emitter.emit("loadingStatus",!1),this.hideModal()})).catch((()=>{this.$emitter.emit("loadingStatus",!1)})):(0,J.Z3)(this.tempData).then((()=>{this.$emitter.emit("messageModal",{status:!0,message:"新增成功"}),this.$emitter.emit("getVendorLsit"),this.hideModal()})).catch((e=>{this.$emitter.emit("messageModal",{status:!1,message:`新增失敗，原因：${JSON.stringify(e.response.data.error)}`})})).finally((()=>{this.$emitter.emit("loadingStatus",!1)}))},deleteVendor(e){(0,J.mV)(e).then((()=>{this.$emitter.emit("messageModal",{status:!0,message:"刪除成功"}),this.$emitter.emit("getVendorLsit"),this.hideModal()})).catch()},showModal(){this.modal.show()},hideModal(){this.tempData={},this.modal.hide()}},mounted(){this.modal=new m.aF(this.$refs.vendorModal),this.$emitter.on("addEditVendor",(e=>{this.status=e.status,e.status||(this.tempData=JSON.parse(JSON.stringify(e.data))),this.showModal()}))}};const ke=(0,w.A)(ge,[["render",be]]);var ve=ke;const ye={class:"modal fade",ref:"message",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",style:{"z-index":"99999"}},Le={class:"modal-dialog"};function Ce(e,t,a,s,o,n){return(0,c.uX)(),(0,c.CE)("div",ye,[(0,c.Lk)("div",Le,[(0,c.Lk)("div",{class:(0,p.C4)(["alert border-2 rounded-0",[o.status?"alert-dark border-dark":"alert-danger border-danger"]])},[(0,c.Lk)("i",{class:(0,p.C4)(["bi me-2",[o.status?"bi-check-square":"bi-exclamation-triangle"]])},null,2),(0,c.eW)((0,p.v_)(o.message),1)],2)])],512)}var Me={data(){return{messageModal:"",message:"",status:!1}},methods:{openModal(){this.messageModal.toggle()}},mounted(){this.messageModal=new m.aF(this.$refs.message),this.$emitter.on("messageModal",(e=>{this.status=e.status,this.message=e.message,this.openModal()}))}};const $e=(0,w.A)(Me,[["render",Ce]]);var Fe=$e;const we={class:"vl-parent"};function Ee(e,t,a,s,o,n){const l=(0,c.g2)("loading");return(0,c.uX)(),(0,c.CE)("div",we,[(0,c.bF)(l,{active:o.status,"can-cancel":!0,"is-full-page":o.fullPage},{default:(0,c.k6)((()=>t[0]||(t[0]=[(0,c.Lk)("div",{class:"loader"},null,-1)]))),_:1},8,["active","is-full-page"])])}var xe={data(){return{status:!1,fullPage:!0}},components:{Loading:d()},mounted(){this.$emitter.on("loadingStatus",(e=>{this.status=e}))}};const De=(0,w.A)(xe,[["render",Ee],["__scopeId","data-v-54c8b574"]]);var Ve=De;const _e={class:"offcanvas offcanvas-end",style:{width:"80% !important","background-color":"#dee0d8"},"data-bs-backdrop":"static",tabindex:"-1",ref:"demoOffcans"},Se={class:"offcanvas-header"},Xe={class:"offcanvas-title",id:"staticBackdropLabel"},Ie={class:"offcanvas-body overflow-x-auto"},Ne={class:"card border-2 border-dark rounded-4 p-2 mb-3"},Oe={class:"table"},Ue={scope:"row text-nowrap"},Ae={class:"card border-2 border-dark rounded-4 p-2"},We={class:"table"},qe={scope:"row text-nowrap"};function Pe(e,t,a,s,o,n){return(0,c.uX)(),(0,c.CE)("div",_e,[(0,c.Lk)("div",Se,[(0,c.Lk)("h5",Xe,(0,p.v_)(o.tempData.name),1),t[0]||(t[0]=(0,c.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"offcanvas","aria-label":"Close"},null,-1))]),(0,c.Lk)("div",Ie,[t[5]||(t[5]=(0,c.Fv)('<nav aria-label="..."><ul class="pagination"><li class="page-item disabled"><a class="page-link">Previous</a></li><li class="page-item active"><a class="page-link" href="#">2024/9</a></li><li class="page-item"><a class="page-link" href="#">2024/10</a></li><li class="page-item"><a class="page-link" href="#">2024/11</a></li><li class="page-item"><a class="page-link" href="#">2024/12</a></li><li class="page-item"><a class="page-link" href="#">Next</a></li></ul></nav>',1)),(0,c.Lk)("div",Ne,[(0,c.Lk)("table",Oe,[(0,c.Lk)("thead",null,[(0,c.Lk)("tr",null,[t[1]||(t[1]=(0,c.Lk)("th",{scope:"col"},"#",-1)),((0,c.uX)(!0),(0,c.CE)(c.FK,null,(0,c.pI)(o.dateList,((e,t)=>((0,c.uX)(),(0,c.CE)("th",{key:t,scope:"col"},(0,p.v_)(e),1)))),128))])]),(0,c.Lk)("tbody",null,[((0,c.uX)(!0),(0,c.CE)(c.FK,null,(0,c.pI)(o.tempData.timeEntries,((e,a)=>((0,c.uX)(),(0,c.CE)("tr",{key:a},[(0,c.Lk)("th",Ue,(0,p.v_)(a+1)+" "+(0,p.v_)(e.employee.name),1),((0,c.uX)(!0),(0,c.CE)(c.FK,null,(0,c.pI)(o.dateList,((e,a)=>((0,c.uX)(),(0,c.CE)("td",{key:a},t[2]||(t[2]=[(0,c.Lk)("input",{type:"time",id:"appt",name:"appt",min:"00:00",max:"20:00",required:""},null,-1),(0,c.eW)(" ~ "),(0,c.Lk)("input",{type:"time",id:"appt",name:"appt",min:"00:00",max:"20:00",required:""},null,-1)]))))),128))])))),128))])])]),(0,c.Lk)("div",Ae,[(0,c.Lk)("table",We,[(0,c.Lk)("thead",null,[(0,c.Lk)("tr",null,[t[3]||(t[3]=(0,c.Lk)("th",{scope:"col"},"#",-1)),((0,c.uX)(!0),(0,c.CE)(c.FK,null,(0,c.pI)(o.dateList,((e,t)=>((0,c.uX)(),(0,c.CE)("th",{key:t,scope:"col"},(0,p.v_)(e),1)))),128))])]),(0,c.Lk)("tbody",null,[((0,c.uX)(!0),(0,c.CE)(c.FK,null,(0,c.pI)(o.tempData.temporaryWorkers,((e,a)=>((0,c.uX)(),(0,c.CE)("tr",{key:a},[(0,c.Lk)("th",qe,(0,p.v_)(a+1)+" "+(0,p.v_)(e.name),1),((0,c.uX)(!0),(0,c.CE)(c.FK,null,(0,c.pI)(o.dateList,((e,a)=>((0,c.uX)(),(0,c.CE)("td",{key:a},t[4]||(t[4]=[(0,c.Lk)("input",{type:"time",id:"appt",name:"appt",min:"00:00",max:"20:00",required:""},null,-1),(0,c.eW)(" ~ "),(0,c.Lk)("input",{type:"time",id:"appt",name:"appt",min:"00:00",max:"20:00",required:""},null,-1)]))))),128))])))),128))])])])])],512)}var je={data(){return{modal:"",tempData:{},startDate:"",dateList:[]}},methods:{showModal(){this.modal.show()},getOrder(e){(0,J.FF)(e).then((e=>{console.log(e.data),this.tempData=e.data,this.showModal(),this.dateList=[],this.dateList=Array.from({length:7},((e,t)=>t)).map((e=>{const t=new Date(this.tempData.startDate);return t.setDate(t.getDate()+e),`${t.getMonth()+1}/${t.getDate()}`}))})).catch((e=>{console.log(e)}))}},mounted(){this.modal=new m.go(this.$refs.demoOffcans),this.$emitter.on("openCall",(e=>{this.getOrder(e)}))}};const Re=(0,w.A)(je,[["render",Pe]]);var Ke=Re;const Te={class:"modal fade","data-bs-backdrop":"static",tabindex:"-1",ref:"caseModal"},Je={class:"modal-dialog modal-lg"},Be={class:"modal-content"},ze={class:"modal-header"},He={class:"modal-title"},Qe={class:"modal-body"},Ze={class:"form-floating mb-3"},Ge={class:"mb-3"},Ye=["value"],et={class:"form-floating mb-3"},tt={class:"form-floating mb-3"},at={class:"row"},st={class:"col"},ot={class:"col"},nt={class:"mt-3"},lt={class:"form-floating mt-3"},it={class:"modal-footer justify-content-between"},rt=["disabled"];function dt(e,t,a,o,n,l){const i=(0,c.g2)("VField"),r=(0,c.g2)("VForm");return(0,c.uX)(),(0,c.CE)("div",Te,[(0,c.Lk)("div",Je,[(0,c.Lk)("div",Be,[(0,c.Lk)("div",ze,[(0,c.Lk)("h5",He,(0,p.v_)(n.isNew?"新增案件":"編輯案件"),1),(0,c.Lk)("button",{type:"button",class:"btn-close",onClick:t[0]||(t[0]=(...e)=>l.hideModal&&l.hideModal(...e))})]),(0,c.bF)(r,{onSubmit:l.submitCase},{default:(0,c.k6)((({meta:a})=>[(0,c.Lk)("div",Qe,[(0,c.Lk)("div",Ze,[(0,c.bF)(i,{name:"案件名稱",rules:"required",class:"form-control",modelValue:n.tempCase.name,"onUpdate:modelValue":t[1]||(t[1]=e=>n.tempCase.name=e)},null,8,["modelValue"]),t[10]||(t[10]=(0,c.Lk)("label",null,"案件名稱",-1))]),(0,c.Lk)("div",Ge,[t[12]||(t[12]=(0,c.Lk)("label",{class:"form-label"},"合作廠商",-1)),(0,c.bo)((0,c.Lk)("select",{class:"form-select","onUpdate:modelValue":t[2]||(t[2]=e=>n.tempCase.vendorId=e),required:""},[t[11]||(t[11]=(0,c.Lk)("option",{value:""},"請選擇廠商",-1)),((0,c.uX)(!0),(0,c.CE)(c.FK,null,(0,c.pI)(n.vendorList,(e=>((0,c.uX)(),(0,c.CE)("option",{key:e._id,value:e._id},(0,p.v_)(e.name),9,Ye)))),128))],512),[[s.u1,n.tempCase.vendorId]])]),(0,c.Lk)("div",et,[(0,c.bF)(i,{name:"施工地址",rules:"required",class:"form-control",modelValue:n.tempCase.address,"onUpdate:modelValue":t[3]||(t[3]=e=>n.tempCase.address=e)},null,8,["modelValue"]),t[13]||(t[13]=(0,c.Lk)("label",null,"施工地址",-1))]),(0,c.Lk)("div",tt,[(0,c.bF)(i,{name:"案件金額",type:"number",rules:"required|min_value:0",class:"form-control",modelValue:n.tempCase.budget,"onUpdate:modelValue":t[4]||(t[4]=e=>n.tempCase.budget=e)},null,8,["modelValue"]),t[14]||(t[14]=(0,c.Lk)("label",null,"案件金額",-1))]),(0,c.Lk)("div",at,[(0,c.Lk)("div",st,[t[15]||(t[15]=(0,c.Lk)("label",{class:"form-label"},"開工日",-1)),(0,c.bo)((0,c.Lk)("input",{type:"date",class:"form-control","onUpdate:modelValue":t[5]||(t[5]=e=>n.tempCase.startDate=e),required:""},null,512),[[s.Jo,n.tempCase.startDate]])]),(0,c.Lk)("div",ot,[t[16]||(t[16]=(0,c.Lk)("label",{class:"form-label"},"完工日",-1)),(0,c.bo)((0,c.Lk)("input",{type:"date",class:"form-control","onUpdate:modelValue":t[6]||(t[6]=e=>n.tempCase.endDate=e)},null,512),[[s.Jo,n.tempCase.endDate]])])]),(0,c.Lk)("div",nt,[t[18]||(t[18]=(0,c.Lk)("label",{class:"form-label"},"案件狀態",-1)),(0,c.bo)((0,c.Lk)("select",{class:"form-select","onUpdate:modelValue":t[7]||(t[7]=e=>n.tempCase.status=e)},t[17]||(t[17]=[(0,c.Lk)("option",{value:"planning"},"規劃中",-1),(0,c.Lk)("option",{value:"in_progress"},"施工中",-1),(0,c.Lk)("option",{value:"completed"},"已完工",-1),(0,c.Lk)("option",{value:"paused"},"暫停",-1)]),512),[[s.u1,n.tempCase.status]])]),(0,c.Lk)("div",lt,[(0,c.bo)((0,c.Lk)("textarea",{class:"form-control",style:{height:"80px"},"onUpdate:modelValue":t[8]||(t[8]=e=>n.tempCase.description=e)},null,512),[[s.Jo,n.tempCase.description]]),t[19]||(t[19]=(0,c.Lk)("label",null,"備註",-1))])]),(0,c.Lk)("div",it,[e.status?(0,c.Q3)("",!0):((0,c.uX)(),(0,c.CE)("button",{key:0,type:"button",class:"btn btn-outline-danger",onClick:t[9]||(t[9]=e=>l.deleteCase(n.tempCase._id))}," 刪除案子 ")),(0,c.Lk)("button",{class:"btn btn-primary",type:"submit",disabled:!a.valid}," 儲存 ",8,rt)])])),_:1},8,["onSubmit"])])])],512)}var ut={data(){return{modal:null,isNew:!0,vendorList:[],tempCase:{}}},methods:{deleteCase(e){(0,J.kn)(e).then((()=>{this.$emitter.emit("messageModal",{status:!0,message:"刪除成功"}),this.$emitter.emit("refreshCaseList"),this.hideModal()})).catch()},async loadVendors(){const e=await(0,J.UP)();this.vendorList=e.data},async submitCase(){this.$emitter.emit("loadingStatus",!0);try{this.tempCase._id?await(0,J.UB)(this.tempCase._id,this.tempCase):await(0,J.tU)(this.tempCase),this.$emitter.emit("messageModal",{status:!0,message:"儲存成功"}),this.$emitter.emit("refreshCaseList"),this.hideModal()}catch(e){this.$emitter.emit("messageModal",{status:!1,message:e.response?.data?.error||"儲存失敗"})}finally{this.$emitter.emit("loadingStatus",!1)}},showModal(){this.loadVendors(),this.modal.show()},hideModal(){this.tempCase={},this.modal.hide()}},mounted(){this.modal=new m.aF(this.$refs.caseModal),this.$emitter.on("addEditCase",(({isNew:e,data:t})=>{this.isNew=e,this.tempCase=e?{}:{...t,vendorId:t.vendor._id},this.showModal()}))}};const mt=(0,w.A)(ut,[["render",dt]]);var ct=mt,pt={data(){return{height:""}},components:{Navbar:x,EmployeesModal:H,VendorModal:ve,CaseModal:ct,Message:Fe,Loading:Ve,Demooffcans:Ke},mounted(){this.height=window.innerHeight-48}};const ht=(0,w.A)(pt,[["render",y]]);var ft=ht,bt=a(1387);const gt=[{path:"/",name:"home",component:()=>a.e(747).then(a.bind(a,1747)),meta:{requiresAuth:!0}},{path:"/case",name:"case",component:()=>a.e(747).then(a.bind(a,1747)),meta:{requiresAuth:!0}},{path:"/order",name:"order",component:()=>a.e(224).then(a.bind(a,6224)),meta:{requiresAuth:!0}},{path:"/employees",name:"employees",component:()=>a.e(537).then(a.bind(a,9537)),meta:{requiresAuth:!0}},{path:"/company",name:"company",component:()=>a.e(946).then(a.bind(a,6946)),meta:{requiresAuth:!0}},{path:"/payroll",name:"payroll",component:()=>a.e(38).then(a.bind(a,9038)),meta:{requiresAuth:!0}},{path:"/login",name:"login",component:()=>a.e(691).then(a.bind(a,9691))}],kt=(0,bt.aE)({history:(0,bt.Bt)(),routes:gt});kt.beforeEach(((e,t,a)=>{const s=localStorage.getItem("token");!e.meta.requiresAuth||s?"/login"===e.path&&s?a("/"):a():a("/login")}));var vt=kt;Object.keys(n).forEach((e=>{"function"===typeof n[e]&&(0,o.Km)(e,n[e])})),(0,o.jK)({generateMessage:(0,l.kg)({zh_TW:i}),validateOnInput:!0}),(0,l.xS)("zh_TW");const yt=(0,u.A)(),Lt=(0,s.Ef)(ft);Lt.config.globalProperties.$emitter=yt,Lt.component("VField",o.D0),Lt.component("VForm",o.lV),Lt.component("ErrorMessage",o.Kw),Lt.use(r.LoadingPlugin),Lt.use(vt),Lt.mount("#app")}},t={};function a(s){var o=t[s];if(void 0!==o)return o.exports;var n=t[s]={exports:{}};return e[s].call(n.exports,n,n.exports,a),n.exports}a.m=e,function(){var e=[];a.O=function(t,s,o,n){if(!s){var l=1/0;for(u=0;u<e.length;u++){s=e[u][0],o=e[u][1],n=e[u][2];for(var i=!0,r=0;r<s.length;r++)(!1&n||l>=n)&&Object.keys(a.O).every((function(e){return a.O[e](s[r])}))?s.splice(r--,1):(i=!1,n<l&&(l=n));if(i){e.splice(u--,1);var d=o();void 0!==d&&(t=d)}}return t}n=n||0;for(var u=e.length;u>0&&e[u-1][2]>n;u--)e[u]=e[u-1];e[u]=[s,o,n]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){a.f={},a.e=function(e){return Promise.all(Object.keys(a.f).reduce((function(t,s){return a.f[s](e,t),t}),[]))}}(),function(){a.u=function(e){return"js/"+e+"."+{38:"684e48b2",224:"930028da",537:"d43681a0",691:"f88d7094",747:"d517f102",946:"93cce5dc"}[e]+".js"}}(),function(){a.miniCssF=function(e){}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="web:";a.l=function(s,o,n,l){if(e[s])e[s].push(o);else{var i,r;if(void 0!==n)for(var d=document.getElementsByTagName("script"),u=0;u<d.length;u++){var m=d[u];if(m.getAttribute("src")==s||m.getAttribute("data-webpack")==t+n){i=m;break}}i||(r=!0,i=document.createElement("script"),i.charset="utf-8",i.timeout=120,a.nc&&i.setAttribute("nonce",a.nc),i.setAttribute("data-webpack",t+n),i.src=s),e[s]=[o];var c=function(t,a){i.onerror=i.onload=null,clearTimeout(p);var o=e[s];if(delete e[s],i.parentNode&&i.parentNode.removeChild(i),o&&o.forEach((function(e){return e(a)})),t)return t(a)},p=setTimeout(c.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=c.bind(null,i.onerror),i.onload=c.bind(null,i.onload),r&&document.head.appendChild(i)}}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){a.p="/sk_-company/"}(),function(){var e={524:0};a.f.j=function(t,s){var o=a.o(e,t)?e[t]:void 0;if(0!==o)if(o)s.push(o[2]);else{var n=new Promise((function(a,s){o=e[t]=[a,s]}));s.push(o[2]=n);var l=a.p+a.u(t),i=new Error,r=function(s){if(a.o(e,t)&&(o=e[t],0!==o&&(e[t]=void 0),o)){var n=s&&("load"===s.type?"missing":s.type),l=s&&s.target&&s.target.src;i.message="Loading chunk "+t+" failed.\n("+n+": "+l+")",i.name="ChunkLoadError",i.type=n,i.request=l,o[1](i)}};a.l(l,r,"chunk-"+t,t)}},a.O.j=function(t){return 0===e[t]};var t=function(t,s){var o,n,l=s[0],i=s[1],r=s[2],d=0;if(l.some((function(t){return 0!==e[t]}))){for(o in i)a.o(i,o)&&(a.m[o]=i[o]);if(r)var u=r(a)}for(t&&t(s);d<l.length;d++)n=l[d],a.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return a.O(u)},s=self["webpackChunkweb"]=self["webpackChunkweb"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=a.O(void 0,[504],(function(){return a(3479)}));s=a.O(s)})();
//# sourceMappingURL=app.8767da71.js.map
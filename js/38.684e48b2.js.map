{"version":3,"file":"js/38.684e48b2.js","mappings":"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","sources":["webpack://web/./src/views/PayrollView.vue","webpack://web/./src/views/PayrollView.vue?0cb5"],"sourcesContent":["<!-- eslint-disable vuejs-accessibility/form-control-has-label -->\n<template>\n  <section class=\"mb-3\">\n    <div class=\"d-flex justify-content-between align-items-center border-bottom pb-2\">\n      <h5 class=\"mb-0\">薪資試算</h5>\n\n      <div class=\"d-flex align-items-center gap-2\">\n        <input\n          type=\"month\"\n          class=\"form-control form-control-sm\"\n          style=\"width: 140px\"\n          v-model=\"selectedMonth\"\n          @change=\"loadPayroll\"\n        />\n\n        <button\n          class=\"btn btn-sm btn-danger\"\n          :disabled=\"payrollList.length === 0 || isGenerating\"\n          @click=\"confirmGenerate\"\n        >\n          確認發薪\n        </button>\n      </div>\n    </div>\n  </section>\n\n  <section class=\"overflow-y-auto\">\n    <table class=\"table table-hover align-middle\">\n      <thead class=\"table-primary sticky-top\">\n        <tr>\n          <th>#</th>\n          <th>員工</th>\n          <th>時薪</th>\n          <th>總工時</th>\n          <th>試算薪資</th>\n          <th></th>\n        </tr>\n      </thead>\n\n      <tbody>\n        <tr\n          v-for=\"(item, index) in payrollList\"\n          :key=\"item.employeeId\"\n          @click=\"selectEmployee(item)\"\n          style=\"cursor:pointer\"\n        >\n          <td>{{ index + 1 }}</td>\n          <td class=\"fw-bold\">{{ item.name }}</td>\n          <td>${{ item.hourlyRate }}</td>\n          <td>{{ item.totalHours }} 小時</td>\n          <td class=\"fw-bold text-success\">\n            ${{ item.totalSalary.toLocaleString() }}\n          </td>\n          <td>\n            <i class=\"bi bi-chevron-right\"></i>\n          </td>\n        </tr>\n\n        <tr v-if=\"payrollList.length === 0\">\n          <td colspan=\"6\" class=\"text-center text-muted py-4\">\n            此月份尚無工時紀錄\n          </td>\n        </tr>\n      </tbody>\n    </table>\n  </section>\n\n  <!-- 員工薪資明細 -->\n  <div v-if=\"selectedEmployee\" class=\"mt-4 border-top pt-3\">\n    <h6>\n      {{ selectedEmployee.name }}｜\n      {{ selectedMonth }} 薪資明細\n    </h6>\n\n    <ul class=\"list-group\">\n      <li class=\"list-group-item\">\n        時薪：${{ selectedEmployee.hourlyRate }}\n      </li>\n      <li class=\"list-group-item\">\n        總工時：{{ selectedEmployee.totalHours }} 小時\n      </li>\n      <li class=\"list-group-item fw-bold\">\n        試算薪資：${{ selectedEmployee.totalSalary.toLocaleString() }}\n      </li>\n    </ul>\n  </div>\n</template>\n\n<script>\nimport {\n  apiGetAllPayroll,\n  apiGetPayroll,\n  apiPostPayroll,\n} from '@/assets/javascript/api';\n\nexport default {\n  name: 'PayrollView',\n\n  data() {\n    return {\n      selectedMonth: new Date().toISOString().slice(0, 7),\n      payrollList: [],\n      selectedEmployee: null,\n      isGenerating: false,\n    };\n  },\n\n  methods: {\n    async loadPayroll() {\n      this.selectedEmployee = null;\n\n      const [year, month] = this.selectedMonth.split('-');\n\n      this.$emitter.emit('loadingStatus', true);\n      try {\n        const res = await apiGetAllPayroll({\n          year,\n          month,\n        });\n        this.payrollList = res.data.payrollList || [];\n      } catch (err) {\n        console.error(err);\n      } finally {\n        this.$emitter.emit('loadingStatus', false);\n      }\n    },\n\n    async selectEmployee(item) {\n      const [year, month] = this.selectedMonth.split('-');\n\n      try {\n        const res = await apiGetPayroll(item.employeeId, {\n          year,\n          month,\n        });\n        this.selectedEmployee = res.data;\n      } catch (err) {\n        console.error(err);\n      }\n    },\n\n    async confirmGenerate() {\n      if (\n        // eslint-disable-next-line no-restricted-globals\n        !confirm(\n          `確定要產生 ${this.selectedMonth} 的薪資紀錄嗎？\\n此動作不可回復！`,\n        )\n      ) return;\n\n      const [year, month] = this.selectedMonth.split('-');\n      this.isGenerating = true;\n\n      try {\n        await apiPostPayroll({ year, month });\n\n        this.$emitter.emit('messageModal', {\n          status: true,\n          message: '薪資紀錄已成功產生',\n        });\n      } catch (err) {\n        this.$emitter.emit('messageModal', {\n          status: false,\n          message: err.response?.data?.error || '產生失敗',\n        });\n      } finally {\n        this.isGenerating = false;\n      }\n    },\n  },\n\n  mounted() {\n    this.loadPayroll();\n  },\n};\n</script>\n","import { render } from \"./PayrollView.vue?vue&type=template&id=6c9fb265\"\nimport script from \"./PayrollView.vue?vue&type=script&lang=js\"\nexport * from \"./PayrollView.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["class","key","_createElementBlock","_Fragment","_createElementVNode","_hoisted_1","_hoisted_2","_hoisted_3","type","style","_cache","$event","$data","selectedMonth","onChange","args","$options","loadPayroll","disabled","payrollList","length","isGenerating","onClick","confirmGenerate","_hoisted_4","_hoisted_5","_hoisted_6","_renderList","item","index","employeeId","selectEmployee","_toDisplayString","_hoisted_8","name","hourlyRate","totalHours","_hoisted_9","totalSalary","toLocaleString","_hoisted_7","_hoisted_10","colspan","_createCommentVNode","selectedEmployee","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","data","Date","toISOString","slice","methods","this","year","month","split","$emitter","emit","res","apiGetAllPayroll","err","console","error","apiGetPayroll","confirm","apiPostPayroll","status","message","response","mounted","__exports__","render"],"sourceRoot":""}
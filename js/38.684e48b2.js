"use strict";(self["webpackChunkweb"]=self["webpackChunkweb"]||[]).push([[38],{9038:function(e,t,l){l.r(t),l.d(t,{default:function(){return _}});var s=l(6768),o=l(5130),a=l(4232);const n={class:"mb-3"},i={class:"d-flex justify-content-between align-items-center border-bottom pb-2"},r={class:"d-flex align-items-center gap-2"},c=["disabled"],d={class:"overflow-y-auto"},u={class:"table table-hover align-middle"},m=["onClick"],h={class:"fw-bold"},y={class:"fw-bold text-success"},p={key:0},k={key:0,class:"mt-4 border-top pt-3"},L={class:"list-group"},b={class:"list-group-item"},g={class:"list-group-item"},f={class:"list-group-item fw-bold"};function v(e,t,l,v,w,E){return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("section",n,[(0,s.Lk)("div",i,[t[3]||(t[3]=(0,s.Lk)("h5",{class:"mb-0"},"薪資試算",-1)),(0,s.Lk)("div",r,[(0,s.bo)((0,s.Lk)("input",{type:"month",class:"form-control form-control-sm",style:{width:"140px"},"onUpdate:modelValue":t[0]||(t[0]=e=>w.selectedMonth=e),onChange:t[1]||(t[1]=(...e)=>E.loadPayroll&&E.loadPayroll(...e))},null,544),[[o.Jo,w.selectedMonth]]),(0,s.Lk)("button",{class:"btn btn-sm btn-danger",disabled:0===w.payrollList.length||w.isGenerating,onClick:t[2]||(t[2]=(...e)=>E.confirmGenerate&&E.confirmGenerate(...e))}," 確認發薪 ",8,c)])])]),(0,s.Lk)("section",d,[(0,s.Lk)("table",u,[t[6]||(t[6]=(0,s.Lk)("thead",{class:"table-primary sticky-top"},[(0,s.Lk)("tr",null,[(0,s.Lk)("th",null,"#"),(0,s.Lk)("th",null,"員工"),(0,s.Lk)("th",null,"時薪"),(0,s.Lk)("th",null,"總工時"),(0,s.Lk)("th",null,"試算薪資"),(0,s.Lk)("th")])],-1)),(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(w.payrollList,((e,l)=>((0,s.uX)(),(0,s.CE)("tr",{key:e.employeeId,onClick:t=>E.selectEmployee(e),style:{cursor:"pointer"}},[(0,s.Lk)("td",null,(0,a.v_)(l+1),1),(0,s.Lk)("td",h,(0,a.v_)(e.name),1),(0,s.Lk)("td",null,"$"+(0,a.v_)(e.hourlyRate),1),(0,s.Lk)("td",null,(0,a.v_)(e.totalHours)+" 小時",1),(0,s.Lk)("td",y," $"+(0,a.v_)(e.totalSalary.toLocaleString()),1),t[4]||(t[4]=(0,s.Lk)("td",null,[(0,s.Lk)("i",{class:"bi bi-chevron-right"})],-1))],8,m)))),128)),0===w.payrollList.length?((0,s.uX)(),(0,s.CE)("tr",p,t[5]||(t[5]=[(0,s.Lk)("td",{colspan:"6",class:"text-center text-muted py-4"}," 此月份尚無工時紀錄 ",-1)]))):(0,s.Q3)("",!0)])])]),w.selectedEmployee?((0,s.uX)(),(0,s.CE)("div",k,[(0,s.Lk)("h6",null,(0,a.v_)(w.selectedEmployee.name)+"｜ "+(0,a.v_)(w.selectedMonth)+" 薪資明細 ",1),(0,s.Lk)("ul",L,[(0,s.Lk)("li",b," 時薪：$"+(0,a.v_)(w.selectedEmployee.hourlyRate),1),(0,s.Lk)("li",g," 總工時："+(0,a.v_)(w.selectedEmployee.totalHours)+" 小時 ",1),(0,s.Lk)("li",f," 試算薪資：$"+(0,a.v_)(w.selectedEmployee.totalSalary.toLocaleString()),1)])])):(0,s.Q3)("",!0)],64)}var w=l(8113),E={name:"PayrollView",data(){return{selectedMonth:(new Date).toISOString().slice(0,7),payrollList:[],selectedEmployee:null,isGenerating:!1}},methods:{async loadPayroll(){this.selectedEmployee=null;const[e,t]=this.selectedMonth.split("-");this.$emitter.emit("loadingStatus",!0);try{const l=await(0,w.TD)({year:e,month:t});this.payrollList=l.data.payrollList||[]}catch(l){console.error(l)}finally{this.$emitter.emit("loadingStatus",!1)}},async selectEmployee(e){const[t,l]=this.selectedMonth.split("-");try{const s=await(0,w.q7)(e.employeeId,{year:t,month:l});this.selectedEmployee=s.data}catch(s){console.error(s)}},async confirmGenerate(){if(!confirm(`確定要產生 ${this.selectedMonth} 的薪資紀錄嗎？\n此動作不可回復！`))return;const[e,t]=this.selectedMonth.split("-");this.isGenerating=!0;try{await(0,w.Us)({year:e,month:t}),this.$emitter.emit("messageModal",{status:!0,message:"薪資紀錄已成功產生"})}catch(l){this.$emitter.emit("messageModal",{status:!1,message:l.response?.data?.error||"產生失敗"})}finally{this.isGenerating=!1}}},mounted(){this.loadPayroll()}},C=l(1241);const M=(0,C.A)(E,[["render",v]]);var _=M}}]);
//# sourceMappingURL=38.684e48b2.js.map